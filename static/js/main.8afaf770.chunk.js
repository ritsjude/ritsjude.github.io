(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{154:function(e,t){e.exports={appId:"71b4a487-eeaa-485a-8c50-8ac050325a3a",scopes:["user.read","calendars.read","calendars.readWrite.shared","people.read"]}},155:function(e,t,n){e.exports={calendar:"NormalSchedule_calendar__oWDRH",subject_content:"NormalSchedule_subject_content__3ckot",user_email_input:"NormalSchedule_user_email_input__Yb8vo",user_email_list:"NormalSchedule_user_email_list__11Hzo"}},231:function(e,t,n){e.exports={trigger:"Page_trigger__3c5rQ",logo:"Page_logo__X9iZl"}},341:function(e,t,n){e.exports=n.p+"static/media/ricoh_logo.79e6298e.png"},349:function(e,t,n){e.exports={moveUpEnd:"QuicklySchedule_moveUpEnd__32igl"}},357:function(e,t,n){e.exports=n(701)},562:function(e,t,n){},695:function(e,t,n){},699:function(e,t,n){},700:function(e,t,n){},701:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(9),o=n.n(i),s=(n(362),n(371),n(562),n(13)),c=n(15),l=n(48),u=n(37),m=n(49),d=n(83),p=n(96),h=n(50),g=(n(303),n(151)),f=(n(114),n(35)),v=(n(304),n(188)),b=(n(566),n(352)),E=(n(340),n(64)),T=(n(305),n(12)),x=n(3),y=n.n(x),k=n(189),S=n(21),O=(n(571),n(131)),j=n(231),M=n.n(j),w=n(341),I=n.n(w),C=(n(702),n(239)),A=(n(703),n(237)),Y=(n(583),n(240)),D=n(355),_=(n(308),n(153)),U=(n(217),n(152)),H=n(11),R=n.n(H),N=(n(587),n(236)),L=n.n(N),P=n(342),V=n(343),z=n.n(V),q=n(344),B=n.n(q),Q=n(354),J=n(154),Z=n.n(J),W=n(353),G=n(130),F=n.n(G),K=function(){function e(){var t=this;Object(s.a)(this,e),this.baseUrl="http://172.25.78.146:1337",this.msalInstance=void 0,this.loginPopup=Object(S.a)(y.a.mark(function e(){return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.msalInstance.loginPopup({scopes:Z.a.scopes,prompt:"select_account"}).catch(function(e){console.log(e)});case 2:case"end":return e.stop()}},e)})),this.logout=function(){t.msalInstance.logout()},this.acquireTokenSilent=Object(S.a)(y.a.mark(function e(){var n;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.msalInstance.acquireTokenSilent({scopes:Z.a.scopes});case 2:return n=e.sent,e.abrupt("return",n);case 4:case"end":return e.stop()}},e)})),this.getAccount=function(){return t.msalInstance.getAccount()},this.msalInstance=new Q.a({auth:{clientId:Z.a.appId},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!0}})}return Object(c.a)(e,null,[{key:"init",get:function(){return this.gInit?this.gInit:(this.gInit=new e,this.gInit)}}]),Object(c.a)(e,[{key:"getAuthenticatedClientToken",value:function(){var e=Object(S.a)(y.a.mark(function e(){var t,n;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.msalInstance.acquireTokenSilent({scopes:Z.a.scopes}).catch(function(e){console.log(e)});case 2:return t=e.sent,n=W.a.init({authProvider:function(e){e(null,t.accessToken)}}),e.abrupt("return",n);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getEvents",value:function(){var e=Object(S.a)(y.a.mark(function e(){var t,n;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getAuthenticatedClientToken();case 2:return t=e.sent,e.next=5,t.api("/me/events").filter("isOrganizer eq true").get().catch(function(e){console.log(e)});case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getUserDetails",value:function(){var e=Object(S.a)(y.a.mark(function e(){var t,n;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getAuthenticatedClientToken();case 2:return t=e.sent,e.next=5,t.api("/me").get().catch(function(e){console.log(e)});case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"scheduleMeetingRoom",value:function(){var e=Object(S.a)(y.a.mark(function e(t){var n,a;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getAuthenticatedClientToken();case 2:return n=e.sent,e.next=5,n.api("/me/events").post(t).catch(function(e){console.log(e)});case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getUserEmail",value:function(){var e=Object(S.a)(y.a.mark(function e(t){var n,a;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getAuthenticatedClientToken();case 2:return n=e.sent,e.next=5,n.api("/me/people").search('"'.concat(t,'"')).get().catch(function(e){console.log(e)});case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getUserPhotoUrl",value:function(){var e=Object(S.a)(y.a.mark(function e(){var t,n,a,r;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getAuthenticatedClientToken();case 2:return t=e.sent,e.next=5,t.api("/me/photo/$value").get().catch(function(e){console.log(e)});case 5:return n=e.sent,a=window.URL||window.webkitURL,r=a.createObjectURL(n),e.abrupt("return",r);case 9:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getSchedule",value:function(){var e=Object(S.a)(y.a.mark(function e(t){var n,a;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getAuthenticatedClientToken();case 2:return n=e.sent,e.next=5,n.api("/me/calendar/getSchedule").post(t).catch(function(e){console.log(e)});case 5:return a=e.sent,e.abrupt("return",a);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"getAllMeetingRooms",value:function(){var e=Object(S.a)(y.a.mark(function e(){var t;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F.a.get("/data.json").catch(function(e){console.log(e)});case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"getAllLoginedUser",value:function(){var e=Object(S.a)(y.a.mark(function e(){var t;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F.a.get("".concat(this.baseUrl,"/usersettings")).catch(function(e){console.log(e)});case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getSpecficIdUser",value:function(){var e=Object(S.a)(y.a.mark(function e(t){var n;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F.a.get("".concat(this.baseUrl,"/usersettings/").concat(t)).catch(function(e){console.log(e)});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"updateLoginUser",value:function(){var e=Object(S.a)(y.a.mark(function e(t,n){var a;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F.a.put("".concat(this.baseUrl,"/usersettings/").concat(t),n).catch(function(e){console.log(e)});case 2:return a=e.sent,e.abrupt("return",a);case 4:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"addLoginUser",value:function(){var e=Object(S.a)(y.a.mark(function e(t){var n;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("newUser:",t),e.next=3,F.a.post("".concat(this.baseUrl,"/usersettings/"),t).catch(function(e){console.log(e)});case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}]),e}();K.gInit=void 0;n(610),n(611),n(612);var X,$=n(155),ee=n.n($),te=U.a.Group;R.a.locale("zh-cn");var ne,ae,re,ie,oe,se,ce,le,ue,me,de,pe,he,ge,fe=Object(h.b)("store")(X=Object(h.c)(X=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e)))._isMounted=!1,n.store=void 0,n.calendarComponentRef=r.a.createRef(),n.gInitApi=void 0,n.state={subjectContent:"",UTCTime:{startTime:"",endTime:""},dataSource:[],autoCompleteValue:"",attendees:[],events:[],resources:[],isModalVisible:!1,selectedMeetingInfo:{name:"",address:""},localTime:{startTime:"Start Time",endTime:"End Time"},isSchedule:!1,currentRoomsInfo:[],currentRooms:[]},n.startSchedule=Object(S.a)(y.a.mark(function e(){var t,a,r,i,o,s,c,l,u;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=n.state,a=t.subjectContent,r=t.UTCTime,i=t.attendees,o=t.selectedMeetingInfo,a&&r.startTime&&r.endTime&&o.address){e.next=4;break}return _.a.warning("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u53c2\u6570\uff01"),e.abrupt("return");case 4:return console.log("[log]--\x3e\u5f00\u59cb\u8fdb\u884c\u4f1a\u8bae\u9884\u7ea6"),n.setState({isSchedule:!0,isModalVisible:!0}),s={subject:a,body:{contentType:"HTML",content:"meeting content"},start:{dateTime:r.startTime,timeZone:"China Standard Time"},end:{dateTime:r.endTime,timeZone:"China Standard Time"},location:{displayName:o.name,locationEmailAddress:o.address},attendees:[{emailAddress:{address:o.address,name:o.name},type:"resource"}]},e.next=9,n.gInitApi.getUserDetails();case 9:if(c=e.sent){e.next=12;break}return e.abrupt("return");case 12:return l={emailAddress:{address:c.mail,name:c.displayName},type:"required"},s.attendees.push(l),i.forEach(function(e){var t={emailAddress:{address:"",name:"unknow"},type:"required"};t.emailAddress.address=e,s.attendees.push(t)}),console.log("[log]--\x3e\u6210\u529f\u5c06\u9884\u7ea6\u4f1a\u8bae\u5ba4\u7684\u53c2\u6570\u5bf9\u8c61\u62fc\u63a5\u6210\u529f\u3002",s),e.next=18,n.gInitApi.scheduleMeetingRoom(s);case 18:if(e.sent){e.next=23;break}return n.setState({isSchedule:!1}),_.a.warning("\u65e5\u671f\u53c2\u6570\u51fa\u9519\uff01"),e.abrupt("return");case 23:return console.log("[log]--\x3e\u6210\u529f\u9884\u7ea6\u4f1a\u8bae\u5ba4,\u6b63\u5728\u7b49\u5f85\u9884\u7ea6\u623f\u95f4\u8fdb\u884c\u54cd\u5e94\u3002"),e.next=26,setInterval(Object(S.a)(y.a.mark(function e(){var t;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.gInitApi.getEvents();case 2:t=e.sent,console.log("[log]--\x3e\u6210\u529f\u83b7\u53d6\u6240\u6709\u81ea\u5df1\u9884\u7ea6\u7684\u4f1a\u8bae\u4e8b\u4ef6\u3002"),t.value[0].attendees.forEach(function(e){return"resource"===e.type&&"accepted"===e.status.response?(clearInterval(u),console.log("[log]--\x3e\u6210\u529f\u9884\u7ea6\u4f1a\u8bae\u5ba4,\u4f1a\u8bae\u5ba4\u63a5\u53d7\u4e86\u4f1a\u8bae\uff0c\u5e76\u66f4\u65b0\u4f1a\u8bae\u8868\u683c\u9875\u9762\u6570\u636e"),n.getSchedule(),void(n._isMounted&&n.setState({subjectContent:"",UTCTime:{startTime:"",endTime:""},dataSource:[],autoCompleteValue:"",attendees:[],localTime:{startTime:"Start Time",endTime:"End Time"},isSchedule:!1,isModalVisible:!1}))):"resource"===e.type&&"declined"===e.status.response?(clearInterval(u),console.log("[log]--\x3e\u9884\u7ea6\u4f1a\u8bae\u5ba4\u5931\u8d25\uff0c\u4f1a\u8bae\u5ba4\u53ef\u80fd\u5df2\u7ecf\u88ab\u9884\u8ba2\uff0c\u5e76\u66f4\u65b0\u4f1a\u8bae\u8868\u683c\u9875\u9762\u6570\u636e\u3002"),n.getSchedule(),void(n._isMounted&&n.setState({subjectContent:"",UTCTime:{startTime:"",endTime:""},dataSource:[],autoCompleteValue:"",attendees:[],localTime:{startTime:"Start Time",endTime:"End Time"},isSchedule:!1,isModalVisible:!1}))):void 0});case 6:case"end":return e.stop()}},e)})),2e3);case 26:u=e.sent;case 27:case"end":return e.stop()}},e)})),n.getSchedule=Object(S.a)(y.a.mark(function e(){var t,a,r,i,o,s,c,l,u,m,d,p,h,g,f,v,b;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("[log]--\x3e \u5f00\u59cb\u83b7\u53d6\u6240\u6709\u4f1a\u8bae\u5ba4\u7684\u9884\u5b9a\u60c5\u51b5\uff01"),t=[],a=[],r=R()().subtract(20,"days").utc().format(),i=R()().add(40,"days").utc().format(),o=localStorage.getItem("RITS_user_setting"),s=JSON.parse(o),c=s.selectedArea,l={schedules:[],startTime:{dateTime:r,timeZone:"UTC"},endTime:{dateTime:i,timeZone:"UTC"},availabilityViewInterval:"30"},u=n.gInitApi.getAllMeetingRooms(),m=n.gInitApi.getUserDetails(),e.next=13,Promise.all([u,m]);case 13:if(d=e.sent,p=Object(k.a)(d,2),h=p[0],g=p[1],console.log("[log]--\x3e \u83b7\u53d6\u6240\u6709\u4f1a\u8bae\u5ba4",h),console.log("[log]--\x3e \u5f97\u5230\u7528\u6237\u7684\u4e2a\u4eba\u4fe1\u606f.",g),g&&h){e.next=21;break}return e.abrupt("return");case 21:return f={address:g.mail,roomName:g.displayName,eventColor:"orange"},v=JSON.parse(JSON.stringify(h[c])),h[c].unshift(f),t=h[c].map(function(e){var t={};return t.id=e.address,t.title=e.roomName,e.eventColor?t.eventColor=e.eventColor:t.eventColor="",l.schedules.push(e.address),t}),e.next=27,n.gInitApi.getSchedule(l);case 27:if(b=e.sent){e.next=30;break}return e.abrupt("return");case 30:console.log("[log]--\x3e \u6210\u529f\u5f97\u5230\u6240\u6709\u7684\u4f1a\u8bae\u9884\u7ea6\u7ed3\u679c\u3002",b),b.value.forEach(function(e){e.scheduleItems.forEach(function(t){var n={};n.resourceId=e.scheduleId,n.id=e.scheduleId,n.start=R.a.utc(t.start.dateTime).local().format(),n.end=R.a.utc(t.end.dateTime).local().format(),n.title=t.subject,a.push(n)})}),n._isMounted&&n.setState({resources:t,events:a,currentRoomsInfo:v}),console.log("[log]--\x3e resource\u548cevents\u7684state\u72b6\u6001\u66f4\u65b0\u6210\u529f.",t,a);case 34:case"end":return e.stop()}},e)})),n.getSubjectContent=function(e){var t=e.target.value;n.setState({subjectContent:t})},n.handleAutoCompleteSearch=function(){var e=Object(S.a)(y.a.mark(function e(t){var a,r,i;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("[log]--\x3e \u5f00\u59cb\u901a\u8fc7\u8f93\u5165\u6846\u7684\u8f93\u5165\u503c\u8fdb\u884c\u67e5\u627e\u6240\u6709\u76f8\u5173\u7684\u90ae\u4ef6\u5730\u5740"),console.log("filterValue:",t),n.setState({autoCompleteValue:t}),t&&!(t.length>=10)){e.next=5;break}return e.abrupt("return");case 5:return e.next=7,n.gInitApi.getUserEmail(t);case 7:if(a=e.sent){e.next=10;break}return e.abrupt("return");case 10:console.log("[log]\u83b7\u53d6\u6240\u6709\u7684\u7528\u6237\u67e5\u8be2\u90ae\u7bb1\u4fe1\u606f\uff1a",a),r=a.value,i=r.map(function(e){return e.scoredEmailAddresses[0].address}),console.log("[log]--\x3e \u6210\u529f\u83b7\u53d6\u6240\u6709\u76f8\u5173\u7684email\u5730\u5740.",i),n.setState({dataSource:t?i:[]});case 15:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.onAutoCompleteSelect=function(e){console.log("[log]--\x3e \u6210\u529f\u9009\u62e9\u641c\u7d22\u7684\u90ae\u4ef6\u5730\u5740\u5217\u8868\uff01",e);var t=new Set(n.state.attendees.slice());t.add(e);var a=Object(D.a)(t);console.log("[log]--\x3e \u6240\u6709\u88ab\u9009\u4e2d\u7684\u90ae\u4ef6\u5730\u5740\u5217\u8868\uff01",a),n.setState({autoCompleteValue:"",attendees:a})},n.handleTimeSelect=function(e){console.log("[log]--\x3e \u6ed1\u52a8\u4f1a\u8bae\u5ba4\u9884\u7ea6\u65f6\u95f4\u683c\uff0c\u5f00\u59cb\u9884\u5b9a\u3002",e);var t=R()(e.startStr).utc().format(),a=R()(e.endStr).utc().format(),r=R.a.utc(t).local().format("YYYY\u5e74MM\u6708DD\u65e5 - HH:mm"),i=R.a.utc(a).local().format("YYYY\u5e74MM\u6708DD\u65e5 - HH:mm");console.log(r,i),n.setState({isModalVisible:!0,UTCTime:{startTime:t,endTime:a},localTime:{startTime:r,endTime:i},selectedMeetingInfo:{name:e.resource._resource.title,address:e.resource._resource.id}}),console.log("[log]--\x3e \u6ed1\u52a8\u4f1a\u8bae\u5ba4\u9884\u7ea6\u65f6\u95f4\u9009\u62e9\u7ed3\u675f\u3002")},n.handleBtnOpenModal=function(){var e=R()().utc().format(),t=R()().add(30,"minutes").utc().format(),a=R.a.utc(e).local().format("YYYY\u5e74MM\u6708DD\u65e5 - HH:mm"),r=R.a.utc(t).local().format("YYYY\u5e74MM\u6708DD\u65e5 - HH:mm");n.setState({isModalVisible:!0,UTCTime:{startTime:e,endTime:t},localTime:{startTime:a,endTime:r}})},n.handleMeetingDetail=function(e){},n.handleModalCancel=function(){console.log("[log]--\x3e \u6a21\u6001\u6846\u9000\u51fa\u6d88\u5931"),n.setState({isModalVisible:!1,UTCTime:{startTime:"",endTime:""},localTime:{startTime:"Start Time",endTime:"End Time"},selectedMeetingInfo:{name:"",address:""}})},n.handleModalOk=function(){console.log("[log]--\x3e \u70b9\u51fb\u6a21\u6001\u6846\u786e\u8ba4\u6309\u94ae"),n.startSchedule()},n.handleDeleteEmailItem=function(e,t){var a=n.state.attendees;n.state.attendees.splice(t,1),n.setState({attendees:a})},n.handlePopupDetail=function(e){console.log("[log] \u67e5\u770b\u4f1a\u8bae\u8be6\u7ec6\u4fe1\u606f",e);var t=e.event,n=R()(t.start).format("YYYY\u5e74MM\u6708DD\u65e5 - HH:mm"),a=R()(t.end).format("YYYY\u5e74MM\u6708DD\u65e5 - HH:mm");console.log(a),g.a.info({title:r.a.createElement("h2",null,"\u4f1a\u8bae\u8be6\u7ec6\u60c5\u62a5"),content:r.a.createElement("div",null,r.a.createElement("h3",null,"\u6807\u9898"),r.a.createElement("p",null,t.title),r.a.createElement("h3",null,"\u4f1a\u8bae\u65f6\u95f4"),r.a.createElement("p",null,n," \u81f3 ",a)),width:"450px",onOk:function(){}})},n.handleStartTime=function(e,t){var a={startTime:R()(t,"YYYY\u5e74MM\u6708DD\u65e5 HH:mm").utc().format(),endTime:R()(t,"YYYY\u5e74MM\u6708DD\u65e5 HH:mm").add("m",30).utc().format()},r={startTime:R()(a.startTime).format("YYYY\u5e74MM\u6708DD\u65e5 - HH:mm"),endTime:R()(a.endTime).format("YYYY\u5e74MM\u6708DD\u65e5 - HH:mm")},i=Object.assign({},n.state.UTCTime,a),o=Object.assign({},n.state.localTime,r);n.setState({UTCTime:i,localTime:o})},n.handleEndTime=function(e,t){var a={endTime:R()(t,"YYYY\u5e74MM\u6708DD\u65e5 HH:mm").utc().format()},r={endTime:R()(a.endTime).format("YYYY\u5e74MM\u6708DD\u65e5 - HH:mm")},i=Object.assign({},n.state.UTCTime,a),o=Object.assign({},n.state.localTime,r);n.setState({UTCTime:i,localTime:o})},n.handleRoomLocationFocus=function(){var e=n.state.currentRoomsInfo.map(function(e){return e.roomName});n.setState({currentRooms:e})},n.handleRoomPositionSelect=function(e){console.log("[log]\u6210\u529f\u9009\u62e9\u4f1a\u8bae\u5ba4\uff1a",e);var t=n.state.currentRoomsInfo.filter(function(t){return t.roomName===e}),a={name:t[0].roomName,address:t[0].address};n.setState({selectedMeetingInfo:a})},n.gInitApi=K.init,n.store=n.props.store,n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=Object(S.a)(y.a.mark(function e(){return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this._isMounted=!0,this.getSchedule();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"render",value:function(){var e=this,t=this.state,n=t.subjectContent,a=t.events,i=t.resources,o=t.autoCompleteValue,s=t.dataSource,c=t.attendees,l=t.isModalVisible,u=t.selectedMeetingInfo,m=t.localTime,d=t.isSchedule,h=t.currentRooms;return this.store.pageStore.isAuthenticated?(console.log("[log]NormalSchedule-state:",this.state),r.a.createElement("div",null,r.a.createElement("div",{className:ee.a.calendar},r.a.createElement(f.a,{style:{marginBottom:"10px"},type:"primary",onClick:this.handleBtnOpenModal},"\u4f1a\u8bae\u9884\u7ea6"),r.a.createElement(P.a,{schedulerLicenseKey:"GPL-My-Project-Is-Open-Source",defaultView:"resourceTimeline",plugins:[z.a,B.a],selectable:!0,resources:i,resourceLabelText:"\u4f1a\u8bae\u5ba4\u540d",events:a,height:"auto",ref:this.calendarComponentRef,select:this.handleTimeSelect,header:{left:"title",center:"",right:"today ,prev, next"},minTime:"07:00:00",maxTime:"19:30:00",eventColor:"green",eventRender:this.handleMeetingDetail,nowIndicator:!0,eventClick:this.handlePopupDetail})),r.a.createElement(g.a,{title:r.a.createElement("h2",null,"\u65b0\u5efa\u4f1a\u8bae"),visible:l,onOk:this.handleModalOk,onCancel:this.handleModalCancel,width:"850px",okText:"\u9884\u7ea6\u4f1a\u8bae",cancelText:"\u53d6\u6d88",confirmLoading:d,destroyOnClose:!0},r.a.createElement("div",{className:ee.a.subject_content},r.a.createElement("h3",null,"\u6807\u9898"),r.a.createElement(te,{compact:!0},r.a.createElement(U.a,{placeholder:"\u6807\u9898",allowClear:!0,value:n,onChange:this.getSubjectContent}))),r.a.createElement("div",{style:{marginBottom:"20px"}},r.a.createElement("h3",null,"\u4f4d\u7f6e"),r.a.createElement(Y.a,{placeholder:"\u8f93\u5165\u4f1a\u8bae\u5730\u70b9",style:{width:220},autoClearSearchValue:!0,value:u.name,dataSource:h,backfill:!0,onFocus:this.handleRoomLocationFocus,onSelect:this.handleRoomPositionSelect})),r.a.createElement("div",{style:{marginBottom:"5px"}},r.a.createElement("h3",null,"\u4f1a\u8bae\u65f6\u95f4"),r.a.createElement("span",{style:{marginLeft:"20px"}},r.a.createElement("b",null,"\u5f00\u59cb\u65f6\u95f4: ")),r.a.createElement("span",{style:{marginRight:"20px"}},r.a.createElement(A.a,{locale:L.a,placeholder:"\u9009\u62e9\u5f00\u59cb\u65e5\u671f",showTime:{minuteStep:5,format:"HH:mm",disabledHours:function(){return[0,1,2,3,4,5,6,19,20,21,22,23]},hideDisabledOptions:!0,placeholder:"\u9009\u62e9\u5f00\u59cb\u65f6\u95f4"},defaultValue:R()(m.startTime,"YYYY\u5e74MM\u6708DD\u65e5 HH:mm"),value:R()(m.startTime,"YYYY\u5e74MM\u6708DD\u65e5 HH:mm"),format:"YYYY\u5e74MM\u6708DD\u65e5 HH:mm",onChange:this.handleStartTime,allowClear:!1})),r.a.createElement("span",null,r.a.createElement("b",null,"\u7ed3\u675f\u65f6\u95f4: ")),r.a.createElement("span",{style:{marginRight:"5px"}},r.a.createElement(A.a,{locale:L.a,placeholder:"\u9009\u62e9\u7ed3\u675f\u65e5\u671f",showTime:{minuteStep:5,format:"HH:mm",disabledHours:function(){return[0,1,2,3,4,5,6,19,20,21,22,23]},hideDisabledOptions:!0,placeholder:"\u9009\u62e9\u7ed3\u675f\u65f6\u95f4"},defaultValue:R()(m.endTime,"YYYY\u5e74MM\u6708DD\u65e5 HH:mm"),value:R()(m.endTime,"YYYY\u5e74MM\u6708DD\u65e5 HH:mm"),format:"YYYY\u5e74MM\u6708DD\u65e5 HH:mm",onChange:this.handleEndTime,allowClear:!1}))),r.a.createElement("div",{className:ee.a.user_email_input},r.a.createElement("h3",null,"\u9080\u8bf7\u8054\u7cfb\u4eba"),r.a.createElement(Y.a,{dataSource:s,style:{width:220},onSelect:this.onAutoCompleteSelect,onSearch:this.handleAutoCompleteSearch,placeholder:"\u641c\u7d22\u9080\u8bf7\u4eba",value:o,allowClear:!0})),r.a.createElement("h3",null,"\u9080\u8bf7\u4eba\u5217\u8868"),r.a.createElement("div",{className:ee.a.user_email_list},r.a.createElement(C.a,{header:r.a.createElement("div",null),itemLayout:"horizontal",size:"small",bordered:!0,dataSource:c,renderItem:function(t,n){return r.a.createElement(C.a.Item,{actions:[r.a.createElement(f.a,{type:"danger",size:"small",onClick:function(t){return e.handleDeleteEmailItem(t,n)}},"delete")]},t)}}))))):r.a.createElement(p.a,{to:"/app"})}}]),t}(a.Component))||X)||X,ve=(n(338),n(87)),be=(n(339),n(51)),Ee=(n(704),n(238)),Te=(n(688),n(73)),xe=n(70),ye=n(349),ke=n.n(ye),Se=Object(h.b)("store")(ne=Object(h.c)(ne=function(e){function t(e){var n;Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).userAgentApplication=void 0,n.startDate=new Date,n.endDate=new Date,n.store=void 0,n._isMounted=!1,n._isMounted=!0,n.pollingBookMeeting=n.pollingBookMeeting.bind(Object(xe.a)(n)),n.isBookMeeting=n.isBookMeeting.bind(Object(xe.a)(n)),n.createMeeting=n.createMeeting.bind(Object(xe.a)(n)),n.getMeetingTime=n.getMeetingTime.bind(Object(xe.a)(n)),n.getMyMeetings=n.getMyMeetings.bind(Object(xe.a)(n)),n.getCurrentAndNextEvents=n.getCurrentAndNextEvents.bind(Object(xe.a)(n)),n.moveUpEnd=n.moveUpEnd.bind(Object(xe.a)(n)),n.userAgentApplication=K.init.msalInstance,n.handleMenuClick=n.handleMenuClick.bind(Object(xe.a)(n));var a=K.init.getAccount();return n.state={loading:!1,nextEvent:null,currentEvent:null,endLoading:!1,delayLoading:!1},n.store=n.props.store.QuicklyStore,a&&(n.getMyMeetings(),n.getCurrentAndNextEvents()),n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.store.pageStore.isAuthenticated&&(this.getMyMeetings(),this.getCurrentAndNextEvents())}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"pollingBookMeeting",value:function(){var e=Object(S.a)(y.a.mark(function e(){var t,n,a;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._isMounted&&this.setState({loading:!0}),this.startDate=new Date,this.endDate=new Date,e.next=5,this.getMeetingTime(this.startDate,this.endDate);case 5:t=e.sent,n=0,a=0;case 8:if(!(a<t.value.length)){e.next=19;break}if(0!==t.value[a].scheduleItems.length){e.next=15;break}return e.next=12,this.createMeeting(this.startDate,this.endDate,t.value[a].scheduleId);case 12:return n=0,this.isBookMeeting(),e.abrupt("return");case 15:n++;case 16:a++,e.next=8;break;case 19:t.value.length===n&&_.a.warning("\u5f53\u524d\u6ca1\u6709\u4f1a\u8bae\u5ba4\uff01");case 21:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"isBookMeeting",value:function(){var e=Object(S.a)(y.a.mark(function e(){var t,n=this;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=setInterval(Object(S.a)(y.a.mark(function e(){var a,r;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.getMyMeetings();case 2:a=e.sent,"accepted"===(r=a.value[0].attendees[0].status.response)?(clearInterval(t),n._isMounted&&n.setState({loading:!1}),n.getCurrentAndNextEvents()):"declined"===r&&(clearInterval(t),n.pollingBookMeeting());case 5:case"end":return e.stop()}},e)})),3e3);case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"createMeeting",value:function(){var e=Object(S.a)(y.a.mark(function e(t,n,a){var r,i;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r={subject:"\u5feb\u901f\u9884\u7ea6\u4f1a\u8bae",body:{contentType:"HTML",content:"Does late morning work for you?"},start:{dateTime:t.toISOString(),timeZone:"UTC"},end:{dateTime:n.toISOString(),timeZone:"UTC"},attendees:[{emailAddress:{address:a},type:"required"}]},e.next=3,K.init.getAuthenticatedClientToken();case 3:return i=e.sent,e.next=6,i.api("/me/events").post(r).catch(function(e){console.log(e)});case 6:case"end":return e.stop()}},e)}));return function(t,n,a){return e.apply(this,arguments)}}()},{key:"getMeetingTime",value:function(){var e=Object(S.a)(y.a.mark(function e(t,n){var a,r,i,o,s,c;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.setMinutes(t.getMinutes()+30),e.next=3,K.init.getAllMeetingRooms();case 3:return a=e.sent,r=this.props.store.settingPageStore.roomArea,i=[],a[r].forEach(function(e){i.push(e.address)}),o={schedules:i,startTime:{dateTime:t},endTime:{dateTime:n},availabilityViewInterval:"30"},e.next=10,K.init.getAuthenticatedClientToken();case 10:return s=e.sent,e.next=13,s.api("/me/calendar/getSchedule").post(o).catch(function(e){console.log(e)});case 13:return c=e.sent,console.log("all",c),e.abrupt("return",c);case 16:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"getMyMeetings",value:function(){var e=Object(S.a)(y.a.mark(function e(){var t,n;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K.init.getAuthenticatedClientToken();case 2:return t=e.sent,e.next=5,t.api("/me/events").filter("isCancelled eq false and isOrganizer eq true").top(1).get().catch(function(e){console.log(e)});case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()},{key:"getCurrentAndNextEvents",value:function(){var e=Object(S.a)(y.a.mark(function e(){var t,n,a,r;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=new Date,e.next=3,K.init.getAuthenticatedClientToken();case 3:return n=e.sent,e.next=6,n.api("/me/calendar/events").orderby("start/dateTime asc").filter("isCancelled eq false and isOrganizer eq true and start/dateTime le '".concat(t.toISOString(),"' and end/dateTime gt '").concat(t.toISOString(),"'")).get().catch(function(e){console.log(e)});case 6:return(a=e.sent)&&this._isMounted&&this.setState({currentEvent:a.value[0]}),e.next=10,n.api("/me/calendar/events").orderby("start/dateTime asc").count(!0).filter("isCancelled eq false and isOrganizer eq true and start/dateTime gt '".concat(t.toISOString(),"'")).top(1).get().catch(function(e){console.log(e)});case 10:(r=e.sent)&&this._isMounted&&this.setState({nextEvent:r.value[0]});case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"moveUpEnd",value:function(){var e=Object(S.a)(y.a.mark(function e(){var t,n,a;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._isMounted&&this.setState({endLoading:!0}),(t=new Date).setSeconds(t.getSeconds()+3),n={end:{dateTime:t.toISOString(),timeZone:"UTC"},isReminderOn:!1,iCalUId:this.state.currentEvent.iCalUId},e.next=6,K.init.getAuthenticatedClientToken();case 6:return a=e.sent,e.next=9,a.api("/me/events/".concat(this.state.currentEvent.id)).update(n).catch(function(e){console.log(e)});case 9:return e.next=11,this.getCurrentAndNextEvents();case 11:this._isMounted&&this.setState({endLoading:!1});case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"handleMenuClick",value:function(){var e=Object(S.a)(y.a.mark(function e(t){var n,a,r;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._isMounted&&this.setState({delayLoading:!0}),n="1"===t.key?R.a.utc(this.state.currentEvent.end.dateTime).add(30,"m").format():"2"===t.key?R.a.utc(this.state.currentEvent.end.dateTime).add(45,"m").format():R.a.utc(this.state.currentEvent.end.dateTime).add(60,"m").format(),a={end:{dateTime:n,timeZone:"UTC"},isReminderOn:!1,iCalUId:this.state.currentEvent.iCalUId},e.next=5,K.init.getAuthenticatedClientToken();case 5:return r=e.sent,e.next=8,r.api("/me/events/".concat(this.state.currentEvent.id)).update(a).catch(function(e){console.log(e)});case 8:return e.next=10,this.getCurrentAndNextEvents();case 10:this._isMounted&&this.setState({delayLoading:!1});case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t,n,r,i,o,s,c,l,u,m=a.createElement(E.b,{onClick:this.handleMenuClick},a.createElement(E.b.Item,{key:"1"},"30 \u5206\u949f"),a.createElement(E.b.Item,{key:"2"},"45 \u5206\u949f"),a.createElement(E.b.Item,{key:"3"},"60 \u5206\u949f")),d=this.state;return console.log(d),d.currentEvent&&(e=d.currentEvent.organizer.emailAddress.name,t=R.a.utc(d.currentEvent.start.dateTime).local().format("YYYY\u5e74MM\u6708DD\u65e5 - HH:mm"),n=R.a.utc(d.currentEvent.end.dateTime).local().format("YYYY\u5e74MM\u6708DD\u65e5 - HH:mm"),r=d.currentEvent.subject,i=d.currentEvent.attendees[0].emailAddress.name),d.nextEvent&&(o=d.nextEvent.organizer.emailAddress.name,s=R.a.utc(d.nextEvent.start.dateTime).local().format("YYYY\u5e74MM\u6708DD\u65e5 - HH:mm"),c=R.a.utc(d.nextEvent.end.dateTime).local().format("YYYY\u5e74MM\u6708DD\u65e5 - HH:mm"),l=d.nextEvent.subject,u=d.nextEvent.location.displayName),a.createElement("div",null,a.createElement("div",{style:{background:"#ECECEC",padding:"30px"}},a.createElement(ve.a,{gutter:16},a.createElement(be.a,{span:24},a.createElement(Ee.a,{title:"\u5f53\u524d\u4f1a\u8bae",bordered:!0},d.currentEvent?a.createElement("div",null,a.createElement(Te.a,{title:r},a.createElement(Te.a.Item,{label:"\u7ec4\u7ec7\u8005"},e),a.createElement(Te.a.Item,{label:"\u5f00\u59cb\u65f6\u95f4"},t),a.createElement(Te.a.Item,{label:"\u7ed3\u675f\u65f6\u95f4"},n),a.createElement(Te.a.Item,{label:"\u5730\u70b9"},i)),a.createElement(v.a,{overlay:m},a.createElement(f.a,{type:"primary",loading:this.state.delayLoading},"\u5ef6\u957f\u4f1a\u8bae ",a.createElement(T.a,{type:"down"}))),a.createElement(f.a,{className:ke.a.moveUpEnd,type:"primary",onClick:this.moveUpEnd,loading:this.state.endLoading},"\u63d0\u524d\u7ed3\u675f")):a.createElement(f.a,{type:"primary",loading:this.state.loading,onClick:this.pollingBookMeeting},"\u7acb\u5373\u9884\u7ea6"))))),a.createElement("div",{style:{background:"#ECECEC",padding:"30px"}},a.createElement(ve.a,{gutter:16},a.createElement(be.a,{span:24},a.createElement(Ee.a,{title:"\u4e0b\u4e00\u4e2a\u4f1a\u8bae",bordered:!0},d.nextEvent?a.createElement(Te.a,{title:l},a.createElement(Te.a.Item,{label:"\u7ec4\u7ec7\u8005"},o),a.createElement(Te.a.Item,{label:"\u5f00\u59cb\u65f6\u95f4"},s),a.createElement(Te.a.Item,{label:"\u7ed3\u675f\u65f6\u95f4"},c),a.createElement(Te.a.Item,{label:"\u5730\u70b9"},u)):"\u65e0")))))}}]),t}(a.Component))||ne)||ne,Oe=(n(693),n(190)),je=(n(695),Object(h.b)("store")(ae=Object(h.c)(ae=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).gInitApi=void 0,n.store=void 0,n.selectRoomArea=function(){var e=Object(S.a)(y.a.mark(function e(t){var a,r,i;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n.store.settingPageStore.setRoomArea(t.target.value),a=localStorage.getItem("RITS_user_setting"),r=JSON.parse(a),i=Object.assign({},r,{selectedArea:t.target.value}),localStorage.setItem("RITS_user_setting",JSON.stringify(i)),console.log(n.store.settingPageStore.roomArea);case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.gInitApi=K.init,n.store=n.props.store,console.log(n.store.settingPageStore.roomArea),n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return this.store.pageStore.isAuthenticated?r.a.createElement("div",{className:"settingPage"},r.a.createElement("h3",null,"\u57fa\u672c\u8bbe\u7f6e"),"1.\u9009\u62e9\u4f1a\u8bae\u5ba4\u533a\u57df",r.a.createElement("div",null,r.a.createElement(Oe.a.Group,{defaultValue:this.store.settingPageStore.roomArea,onChange:this.selectRoomArea},r.a.createElement(Oe.a.Button,{value:"g7"},"RITS-G7\u4f1a\u8bae\u5ba4"),r.a.createElement(Oe.a.Button,{value:"epqq"},"EPQQ\u4f1a\u8bae\u5ba4")))):r.a.createElement(p.a,{to:"/app"})}}]),t}(a.Component))||ae)||ae),Me=O.a.Header,we=O.a.Content,Ie=O.a.Sider,Ce=Object(h.b)("store")(re=Object(h.c)(re=function(e){function t(e){var n;Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e)))._isMounted=!1,n.store=void 0,n.gInitApi=void 0,n.getUserProfile=Object(S.a)(y.a.mark(function e(){var t,a,r,i,o,s,c,l,u,m,d;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.store.pageStore,e.prev=1,a=n.gInitApi.getUserDetails(),r=n.gInitApi.getUserPhotoUrl(),i=n.gInitApi.acquireTokenSilent(),e.next=7,Promise.all([a,r,i]);case 7:o=e.sent,s=Object(k.a)(o,3),c=s[0],l=s[1],s[2].accessToken&&(t.setIsAuthenticated(!0),n._isMounted&&n.setState({isAuthenticated:!0,isLoginLoading:!1,user:{displayName:c.displayName,email:c.mail},error:null,userPhotoUrl:l})),u=localStorage.getItem("RITS_user_setting"),m=JSON.parse(u),console.log("localUserSetting:",m),d={userEmail:n.state.user.email,selectedArea:"g7"},!m&&n.state.user.email?localStorage.setItem("RITS_user_setting",JSON.stringify(d)):c.mail===m.userEmail?n.store.settingPageStore.setRoomArea(m.selectedArea):localStorage.setItem("RITS_user_setting",JSON.stringify(d)),e.next=25;break;case 20:e.prev=20,e.t0=e.catch(1),"get accessToken error !!!",t.setIsAuthenticated(!1),n.setState({isAuthenticated:!1,isLoginLoading:!1,user:{},error:"get accessToken error !!!"});case 25:case"end":return e.stop()}},e,null,[[1,20]])})),n.toggle=function(){n.setState({collapsed:!n.state.collapsed})},n.login=Object(S.a)(y.a.mark(function e(){var t;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.store.pageStore,e.prev=1,n.setState({isLoginLoading:!0}),e.next=5,n.gInitApi.loginPopup();case 5:return e.next=7,n.getUserProfile();case 7:e.next=14;break;case 9:e.prev=9,e.t0=e.catch(1),"Login error\uff01\uff01\uff01",t.setIsAuthenticated(!1),n.setState({isAuthenticated:!1,isLoginLoading:!1,error:"Login error\uff01\uff01\uff01"});case 14:case"end":return e.stop()}},e,null,[[1,9]])})),n.gInitApi=K.init;var a=n.gInitApi.getAccount();return n.store=n.props.store,n.state={collapsed:!1,isAuthenticated:null!==a,user:{displayName:"\u7528\u6237\u540d",email:""},error:null,userPhotoUrl:"https://zos.alipayobjects.com/rmsportal/ODTLcjxAfvqbxHnVXCYX.png",isLoginLoading:!1},a&&n.getUserProfile(),n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=Object(S.a)(y.a.mark(function e(){return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this._isMounted=!0;case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"render",value:function(){var e=this.props,t=e.match,n=e.location,a=this.state,i=a.isAuthenticated,o=a.user,s=a.collapsed,c=a.userPhotoUrl,l=a.isLoginLoading;console.log("page state:",this.state);var u=r.a.createElement(E.b,null,r.a.createElement(E.b.Item,{onClick:this.gInitApi.logout},r.a.createElement(T.a,{type:"logout"}),r.a.createElement("span",null,"\u9000\u51fa\u767b\u5f55")));return r.a.createElement(O.a,null,r.a.createElement(Ie,{trigger:null,collapsible:!0,collapsed:s},r.a.createElement("div",{className:M.a.logo},r.a.createElement("img",{style:{height:"100%"},src:I.a,alt:"logo"})),r.a.createElement(E.b,{theme:"dark",mode:"inline",defaultSelectedKeys:["/app"],selectedKeys:[n.pathname]},r.a.createElement(E.b.Item,{key:"/app"},r.a.createElement(d.b,{to:t.url},r.a.createElement(T.a,{type:"schedule"}),r.a.createElement("span",null,"\u5feb\u901f\u62a2\u4f1a\u8bae\u5ba4"))),r.a.createElement(E.b.Item,{key:"/app/normal"},r.a.createElement(d.b,{to:"".concat(t.url,"/normal")},r.a.createElement(T.a,{type:"gold"}),r.a.createElement("span",null,"\u9884\u7ea6\u4f1a\u8bae\u5ba4"))),r.a.createElement(E.b.Item,{key:"/app/other"},r.a.createElement(d.b,{to:"".concat(t.url,"/other")},r.a.createElement(T.a,{type:"setting"}),r.a.createElement("span",null,"\u8bbe\u5b9a\u9009\u9879"))))),r.a.createElement(O.a,null,r.a.createElement(Me,{style:{position:"relative",background:"#fff",padding:0}},r.a.createElement(T.a,{className:M.a.trigger,type:s?"menu-unfold":"menu-fold",onClick:this.toggle}),r.a.createElement("span",{style:{position:"absolute",right:"40px"}},r.a.createElement(v.a,{overlay:u},r.a.createElement("a",{href:"###"},r.a.createElement(b.a,{src:c}),r.a.createElement("span",{style:{fontSize:"16px"}}," ",o.displayName))))),r.a.createElement(we,{style:{margin:"24px 16px",padding:24,background:"#fff",minHeight:280}},r.a.createElement(p.d,null,r.a.createElement(p.b,{exact:!0,path:t.path,component:Se}),r.a.createElement(p.b,{path:"".concat(t.path,"/normal"),component:fe}),r.a.createElement(p.b,{path:"".concat(t.path,"/other"),component:je})))),r.a.createElement(g.a,{title:"\u767b\u5f55",visible:!i,footer:r.a.createElement(f.a,{type:"primary",loading:l,onClick:this.login},"\u4f7f\u7528O365\u8d26\u53f7\u767b\u5f55"),centered:!0,closable:!1},r.a.createElement("p",null,"\u6b22\u8fce\u6765\u5230RITS\u5185\u90e8\u4f1a\u8bae\u9884\u7ea6\u7cfb\u7edf"),r.a.createElement("p",null,"\u5982\u9700\u4f7f\u7528\u8be5\u7cfb\u7edf\u8fdb\u884c\u4f1a\u8bae\u9884\u7ea6\u8bf7\u4f7f\u7528\u516c\u53f8\u7684O365\u90ae\u7bb1\u8d26\u53f7\u8fdb\u884c\u767b\u5f55\uff01"),r.a.createElement("p",null,"\u76ee\u524d\u4f1a\u8bae\u623f\u95f4\u53ea\u652f\u6301RITS G7\u4f1a\u8bae\u5ba4\u548cEPQQ\u4f1a\u8bae\u5ba4\uff01"),r.a.createElement("p",null,"\u8c22\u8c22\uff01")))}}]),t}(a.Component))||re)||re,Ae=(n(699),n(700),function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).gInitApi=void 0,n.getUserProfile=Object(S.a)(y.a.mark(function e(){return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.gInitApi.acquireTokenSilent();case 3:e.sent&&n.setState({isAuthenticated:!0,error:null}),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),"get accessToken error !!!",n.setState({isAuthenticated:!1,error:"get accessToken error !!!"});case 11:case"end":return e.stop()}},e,null,[[0,7]])})),n.login=Object(S.a)(y.a.mark(function e(){return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.gInitApi.loginPopup();case 3:return e.next=5,n.getUserProfile();case 5:e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),"Login error\uff01\uff01\uff01",n.setState({isAuthenticated:!1,error:"Login error\uff01\uff01\uff01"});case 11:case"end":return e.stop()}},e,null,[[0,7]])})),n.gInitApi=K.init,n.state={isAuthenticated:!1,error:null},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(p.a,{to:"/app"})}}]),t}(a.Component)),Ye=n(68),De=n(69),_e=(n(230),n(23)),Ue={quicklyStore:new(ie=function e(){var t=this;Object(s.a)(this,e),Object(Ye.a)(this,"Qloading",oe,this),Object(Ye.a)(this,"a",se,this),Object(_e.e)(function(e){console.log(t.Qloading)})},oe=Object(De.a)(ie.prototype,"Qloading",[_e.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),se=Object(De.a)(ie.prototype,"a",[_e.d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(){e.Qloading=!0}}}),ie),settingPageStore:new(ce=function e(){Object(s.a)(this,e),Object(Ye.a)(this,"roomArea",le,this),Object(Ye.a)(this,"setRoomArea",ue,this)},le=Object(De.a)(ce.prototype,"roomArea",[_e.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"g7"}}),ue=Object(De.a)(ce.prototype,"setRoomArea",[_e.d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.roomArea=t}}}),ce),pageStore:new(me=function e(){Object(s.a)(this,e),Object(Ye.a)(this,"id",de,this),Object(Ye.a)(this,"isAuthenticated",pe,this),Object(Ye.a)(this,"setId",he,this),Object(Ye.a)(this,"setIsAuthenticated",ge,this)},de=Object(De.a)(me.prototype,"id",[_e.m],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),pe=Object(De.a)(me.prototype,"isAuthenticated",[_e.m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),he=Object(De.a)(me.prototype,"setId",[_e.d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.id=t}}}),ge=Object(De.a)(me.prototype,"setIsAuthenticated",[_e.d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){var e=this;return function(t){e.isAuthenticated=t}}}),me)},He=function(e){function t(e){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).call(this,e))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return r.a.createElement(h.a,{store:Ue},r.a.createElement("div",{className:"App"},r.a.createElement(d.a,null,r.a.createElement(p.d,null,r.a.createElement(p.b,{exact:!0,path:"/",component:Ae}),r.a.createElement(p.b,{path:"/app",component:Ce})))))}}]),t}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(He,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[357,1,2]]]);
//# sourceMappingURL=main.8afaf770.chunk.js.map